% Chapter Template

% popular unsolved research
%problem in the computer vision field


\chapter{Introduction} % Main chapter title

\label{introduction} % Change X to a consecutive number; for referencing this chapter elsewhere, use \ref{ChapterX}
Human 2d pose estimation has gained more and more attraction in recent years.
For example, \textit{Facebook}, one of the \textit{Big Five} technology companies, has published 73 research paper targeting the
problem of pose estimation in the last three years.
The most popular ones are \textit{DensePose, VideoPose3d} or \textit{Mask R-CNN}~\cite{fbPub, DensePose, videopose3d, maskrcnn}.
A company in Canada \textit{wrnch.ai} even specialized on keypoint recognition from image and video data with a
lot of product options~\cite{wrnch}.
Furthermore, many enterprises are becoming more and more interested in Sports Content Analysis (SPA)
e.g. \textit{Bloomberg, SAP}, and \textit{Panasonic}, just naming a few~\cite{sappanasonic, spaBloomberg}.
\\\mbox{}\\
But how did this topic get into such a demanded focal point?
One of the reasons are the various application areas to which pose estimation can be applied to.
Main fields are sports, visual surveillance, autonomous driving, entertainment, health care and
robotics~\cite{olympicsport, surveillance, kinectWalkDepression}.
For example \textit{Vaak}, a Japanese startup, developed a software, which would detect shoplifters,
even before they were able to remove items from a store.
This yielded in a drastic reduction in stealing crimes in stores~\cite{vaak}.
\\\mbox{}\\
The exercise of sport not via visiting a sports course, gym or club became of fundamental severance in 2020,
when the Coronavirus SARS-CoV-2 spread the entire world~\cite{coronarki}.
Many courses such as Yoga, Pilates, or general fitness routines went online
and were often conducted via Zoom, Instagram Live, or other video streaming technologies~\cite{coronalife}.
However, what participants were often missing, was the feedback of the coach on how the exercise was going, and
whether it was done right or wrong.
So in 2020 more than ever was missed a technology, which is good at pose estimation, or even further, action
recognition, in sports.
\\\mbox{}\\
Most investigations in this field target everyday activities not including complex poses, which can be encountered in
professional sports.
This is why these architectures often fail when applied to more complex movements.
For competitive sports, there are various metrics of high interest depending on the environment.
Competition and training can be differentiated as can be sports executed by multiple athletes versus single combats.
Team sports, such as basketball or soccer, are interested in predictions about
how the other team behaves during the game and which would be the best reaction to their behavior for winning
the game.
During practice, 2d pose recognition can help to optimize the sports-person movements by taking the role of a coach.
This could provide an answer to the question on how certain activities might be optimized. \\
Single competitive sports with very complex movement routines are for example gymnastics and figure ice skating.
Both sports include various artistic body movements, which are not part of daily activities.
Even famous and well-rated 2d pose recognition networks such as \textit{OpenPose} or \textit{VideoPose3d} fail to recognize these
poses.
\\\mbox{}\\
%If this problem was solved, it could help with action recognition and support during practice or relieve the jury
%on competitions.
%A predictor could for example suggest, what an athlete should do to land a certain jump.
%On the other hand, jury is rare and the job sitting all day in the ice-rink on weekends with only a very small
%salary is not very attractive.
%In fact, people often complain scoring is not executed fairly~\cite{ungerjuryinterview, juryunger3minutes, unfairjudge}.
%\\\mbox{}\\
Especially in figure ice skating an accurate 2d pose recognition module could make a huge contribution.
This is why this paper investigates 2d pose recognition with a special focus on figure ice skating.
%
%Don't forget to sum thesis up here


%----------------------------------------------------------------------------------------
%	SECTION 1
%----------------------------------------------------------------------------------------


%More and more online trainings - corona virus: often via Instagram life or Zoom.
%We as humans can tell whether the person does the movement right or not, so it should be possible for neural
%networks as well to recognize.
%Everyone has a mobile phone with a camera. No difficult setup needed and no additional hardware.
%
%In some real-world scenarios (e.g. vehicle accidents and criminal activi-
%ties), intelligent machines do not have the luxury of waiting for
%the entire action execution before having to react to the action
%contained in it. For example, being able to predict a dangerous
%driving situation before it occurs; opposed to recognizing it
%thereafte
%
%- profi knowns what action is performed
%    - slow motion: can detect possible errors
%    - put videos next to each other: who jumps higher, turns faster - how fast is difficult
%    - errors difficult to spot -> many ways to land a jump
%- general tasks
%- application areas:
%    - police, games, sports, health
%- in sports
%- figure skating as speciality


%----------------------------------------------------------------------------------------
%	SECTION 1
%----------------------------------------------------------------------------------------


\section{Motivation}

    A working 2d pose estimator could make a huge contribution to figure ice skating.
    In particular when building an action recognizer on top of it.
    However, as of today, this was not possible yet due to the complex poses and the different gliding movements
    on the ice.
    Indeed, spins with their fast rotation and stretching poses are of high complexity to these estimators.
    Such an estimator could support fair scoring during competitions or help to improve motion sequences during
    practice.
    \\\mbox{}\\
    With the downward trend of jury staff and the increasing demand for more small competitions, the jury is asked
    more and more in figure ice skating.
    Particularly the role of the technical specialist or controller diagnosing the individual elements on the ice
    is of high demand.
    In recent years, some competitions were even canceled, because they were not able to find the inevitable jury.
    In addition, sitting all day in the cold ice rink for only a very low salary is not attractive at all.
    These long demanding days challenge concentration and many competition participants often complain about jury
    not rating fairly enough,
    completely forgetting the demanding work the jury has to do~\cite{ungerjuryinterview, juryunger3minutes, unfairjudge}.
    Here a 2d pose estimator could contribute by recognizing the different elements or even scoring.
    This would not only relieve the jury but also could increase fairness.
    \\\mbox{}\\
    During practice, 2d pose estimators could examine the specific motions during elements and give hints on how to
    improve these.
    Probably they could even suggest certain exercises to learn an element like a spin, jump, or certain step.
    Additionally, they could keep track of training progresses and provide analysis metrics to the skaters and coaches.
    \\\mbox{}\\
    All in all, 2d pose estimation is very interesting not only because of all the possible different appliance
    possibilities in this sport,
    but as well because of the
    challenging task to build an appropriate estimator, which was not possible until today.

    % - einsatzbereiche - trainer-app, preisrichter-knappheit
    % - unger memo
    % - große komplexität von eiskunstlauf, fachwissen notwendig
    % - keine erfolgreichen studies bis jetzt, neulich veröffentlichtes dataset
    % Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam ultricies lacinia euismod. Nam tempus risus in
    %dolor
    % rhoncus in interdum enim tincidunt. Donec vel nunc neque. In condimentum ullamcorper quam non consequat. Fusce
    % sagittis tempor feugiat. Fusce magna erat, molestie eu convallis ut, tempus sed arcu. Quisque molestie, ante a
    % tincidunt ullamcorper, sapien enim dignissim lacus, in semper nibh erat lobortis purus. Integer dapibus ligula ac
    % risus convallis pellentesque.


    \section{Related Work}

    2d pose estimation sets the baseline for machines to understand actions.
    It is the problem of localizing human joints or keypoints in images and videos.
    Many research studies explored and researched this topic already with the most popular ones being \textit{OpenPose}
    and \textit{VideoPose3d}~\cite{openpose, videopose3d}.
\\\mbox{}\\
    For 2d pose recognition there are mainly two general procedures: either \textit{top-down} or \textit{bottom-up}.
    \textit{Top-down} first detects a person and then finds their keypoints.
    Whereas \textit{bottom-up} first detects all keypoints in the image and then refers to the corresponding people.
    For top-down it is argued, that if a person is not detected via a bounding-box or alike, no keypoints can be
    found.
    This would lead to more undetected keypoints in the frames of a video.
    When there are many people in the image with many occlusions, people often can not be detected.
    However, when a person is correctly detected, it is said that accuracy would be higher~\cite{synergetic}.
\\\mbox{}\\
    A famous \textit{top-down} approach for example is \textit{Mask R-CNN} developed by the \textit{Facebook AI Research} team. It consists
    of three branches and two stages.
    The first stage presents the \textit{Region Proposal Network (RPN)}. It proposes candidate bounding-boxes for objects.
    The second stage performs classification and bounding-box regression by extracting features using region of
    interest pooling, which they refer to as \textit{RoiPool}.
    Additionally, \textit{Mask R-CNN} predicts a binary mask for each \textit{ROI} in the second stage.
    They receive top results in the \textit{COCO} challenges for instance segmentation, bounding-box object detection, and
    person keypoint detection~\cite{maskrcnn}.
    Other famous \textit{top-down} approaches include \textit{Simple Baselines}, \textit{the Cascaded Pyramid Network} or
    \textit{Deep High-Resolution Learning}~\cite{simplebaselines,pyramidnetwork, highres}.
\\\mbox{}\\
    One of the most discussed and popular \textit{bottom-up} approaches as of today is \textit{OpenPose}.
    Their neural net predicts vector fields for the joint connections, which they call \textit{Part Affinity Fields (PAF)}.
    Additionally, it estimates candidate keypoint locations via Gaussian distributions.
    These they refer to as \textit{Part Confidence Maps}.
    From these detections, they refer to the associated human poses.
    \textit{OpenPose} shows very good results on the MPII and COCO challenges.
    They highlight their performance, which especially shows it's strength when detecting multiple people.
    The performance wouldn't change even if more and more people enter the scene.
    With sufficient hardware equipment, this would even show decent results in realtime~\cite{openpose}.\\
    In a newer research, they additionally pay attention to the temporal characteristic in video sequences in
    their work of \textit{Spatio Temporal Fields}.
    Their approach is able to track multiple people's poses across frames being runtime-invariant to the number
    of people in the frames.
    Besides, they receive highly competitive results on the \textit{PoseTrack} challenges~\cite{staf}.
    Some other famous \textit{bottom-up} approaches include \textit{Convolutional Pose Machines} and
    \textit{PifPaf}~\cite{convpose, pifpaf}.
\\\mbox{}\\
    %- bottom-up/ top-down
    % - one/vs multiple people
    %figure skating
    % - datasets/ mocap
    The COCO, MPII and PoseTrack challenges lead to several studies in the pose estimation field.
    Nevertheless, their dataset targets rather simple daily activities.
    There have been only conducted a few studies on competitive sports such as basketball, ice-hockey or
    swimming~\cite{synergetic, posehockey, swimm}.
    For sports including full-body flexibility or special unconventional jump or turn rotations as can be found
    in dance, gymnastics or figure ice skating,
    there have been only a few studies~\cite{dance, figureskatingsimulation, scorefigureskating, fsd10}.\\
    Studies on figure ice skating topics encounter three main problems:
    The first is domain knowledge.
    In C. {Xu} et Al.'s research~\cite{scorefigureskating}, they try to predict the technical and performance scores from video data with
    only the
    ice skating program as video input and the judge scores as labels.
    This will very likely not result in useful results since first, the figure ice skating judging system adjusts
    every year,
    second, there are always different judges on the competitions who all have their own rating style, and third
    however, the skater is one of the always winning
    ones, this skater can do a good program falling at the main elements and still score very well, because the
    jury tends to be biased.
    This is one of the main controversies in the figure ice skating fairness of program judgment.
    Another problem is the missing dataset.
    There didn't exist a dataset with joint labeling until FSD-10~\cite{fsd10}, which only came out at the
    beginning of the year 2020.
    One very interesting study from Yu, Ri et Al.~\cite{simplebaselines} tries to create simulations from the figure ice skating elements.
    They exactly encountered the problem, that pose estimation currently does not work on difficult pose sequences
    such as spins or very flexible positions.
    However, they were able to successfully predict jumps and simple steps from videos into 3d
    simulation.

    \section{Purpose and Research Question}
In this thesis an approach will be presented on human pose detection in single figure ice skating.
In particular, the developed architecture ought to run on devices with lower computation power such as mobile phones.
Several experiments will be conducted and evaluated leading to the proposed architecture.
Due to the thesis' application scope of figure ice skating, the resulting algorithm should only detect the main character in the image
and neglect background noise or other people.
In regard to these requirements, following research questions will be addressed:
\begin{itemize}
    \item How can an appropriate dataset be created for 2d human pose detection in figure ice skating?
    \item Which network architecture efficiently detects human joints from image data and at the same time is able to
    run on devices with low computational power?
\end{itemize}

\section{Approach and Methodology}
To develop a working machine learning algorithm, the correct dataset according to the problem must be chosen wisely.
Since there was no dataset publicly released targeting human joint recognition in figure ice skating at the writing time
of this thesis, a prove of concept was developed, investigating how such a dataset could be generated.
Therefore, motion capturing data was recorded at the ice rink.
These were then preprocessed and applied to 3d scenes in the open-source 3d computer animation software Blender~\cite{blender}.
Moreover, this prototypical approach presents how the animation data can be transmitted into a valuable dataset applicable for machine learning
algorithms of pose recognition tasks.
\\\mbox{}\\
The main part of the thesis investigates the generation of an end-to-end method, which would be able to detect human joints
from images.
Therefore, three neural networks were created and multiple network architectures in reference to these modules were tested.
The resulting architecture is based on state-of-the-art concepts of \glspl{CNN}.
For finding the best architecture the convolutional layers of the network were visualized.
Further, multiple evaluation metrics were tracked and analyzed.
The limitations of this thesis will be discussed and further research and development ideas will be proposed.



\section{Scope and Limitation}
To ensure the compliant scope of effort and fixed time frame of this master thesis, the following limitations were set:

\begin{itemize}
    \item A dataset generation technique will be presented, but not created as a whole project.
    Nevertheless, an applicable existing one will be used.
    \item The ablation study will include chosen tests on network architecture, optimization and loss functions.
    \gls{NAS} or grid search approaches are out of scope.
\end{itemize}
\section{Target Group}
Due to the application scope of figure ice skating, the focal target groups are skaters, coaches and jury in figure ice skating.
Further, institutes such as the \gls{ISU}, represent a group of interest due to their commitment of supporting research and development
in figure ice skating.
In particular, artistic sports such as gymnastics or dance will benefit from this research work, as will physio therapy or
in general industries interested in human joint detection.

    \section{Outline}
    In this work the performance of \textit{VideoPose3d, OpenPose,} and \textit{wrnch.ai} on figure ice skating elements was tested,
but the result showed a lot of failed frames, especially spins, such as the artistic Biellmann spin.
This rose motivation to further look into datasets, dataset creation and suitable neural network architectures for labeling
figure ice skating videos. While at the same time keeping in mind a good performing architecture, which would be able to run on mobile phones.\\
Altogether, after understanding the application scope of figure ice skating explained in~\autoref{figureskating}, the theoretical
background will be explained in~\autoref{theory} on which the subsequent research work builds upon.
The creation of a figure ice skating dataset with the help of the XSens motion capturing data in a
    real figure ice skating arena
    environment will be elaborated in~\autoref{dataset}.
    In detail, the creation of a dataset from these motion capturing data with the help of Blender and
    Makehuman will be proposed in~\autoref{motioncapture}.
    An end-to-end fully convolutional architecture consisting of three modules for background extraction,
    body part and keypoint detection will be presented in~\autoref{method}.
    Moreover, multiple experiments with network architectures, learning optimization techniques, and loss functions will be discussed
    in~\autoref{experiments}.
    To conclude this thesis, several concepts, where these studies should continue to, will be recommended in~\autoref{conclusion}.


%    \begin{flushleft}
%        figure-skating/ datasets
%    \end{flushleft}

